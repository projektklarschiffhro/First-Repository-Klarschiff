<?xml version='1.0' encoding='utf-8' ?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/></head><body><p>@Deprecated</p><p class="title">Entwicklerhandbuch</p><ol style="list-style: none;"><li><a href="#Spring">Spring</a></li><li><a href="#Projektstruktur">Projektstruktur</a></li><li><a href="#WebanwendungmitSpring">Webanwendung mit Spring</a></li><li><a href="#Zustndigkeitsfinder">Zuständigkeitsfinder</a></li><li><a href="#Einstellungen">Einstellungen</a></li><li><a href="#Encoding">Encoding</a></li><li><a href="#Dokumentation">Dokumentation</a></li><li><a href="#Javadoc">Javadoc</a></li><li><a href="#a1.Einleitung">1. Einleitung</a><ol style="list-style: none;"><li><a href="#a1.1WasistKlarschiff">1.1 Was ist Klarschiff</a></li><li><a href="#a1.2WarumKlarschiff">1.2 Warum Klarschiff</a></li><li><a href="#a1.3Lizenz">1.3 Lizenz</a></li><li><a href="#a1.4MglichkeitenzurMitwirkung">1.4 Möglichkeiten zur Mitwirkung</a></li><li><a href="#a1.5Entwicklerdokumentation">1.5 Entwicklerdokumentation</a></li></ol></li><li><a href="#a2.Allgemeines">2. Allgemeines</a><ol style="list-style: none;"><li><a href="#a2.1Programmiersprache">2.1 Programmiersprache</a></li><li><a href="#a2.2SoftwaredritterParteien">2.2 Software dritter Parteien</a></li><li><a href="#a2.3Systemvoraussetzungen">2.3 Systemvoraussetzungen </a><ol style="list-style: none;"><li><a href="#a2.3.1ZurAusfhrungvonKlarschiff">2.3.1 Zur Ausführung von Klarschiff</a></li><li><a href="#a2.3.2ZurEntwicklungvonKlarschiff">2.3.2 Zur Entwicklung von Klarschiff</a></li></ol></li><li><a href="#a2.4Entwicklungsumgebung">2.4 Entwicklungsumgebung</a><ol style="list-style: none;"><li><a href="#a2.4.1EntwicklungsumgebungFrontend">2.4.1 Entwicklungsumgebung Frontend</a></li><li><a href="#a2.4.2.EntwicklungsumgebungBackend">2.4.2. Entwicklungsumgebung Backend</a></li></ol></li></ol></li><li><a href="#a3.Softwarekomponenten">3. Softwarekomponenten</a><ol style="list-style: none;"><li><a href="#a3.1Email">3.1 Email</a></li><li><a href="#a3.2Sonstiges">3.2 Sonstiges</a></li></ol></li><li><a href="#a4.Ausblick">4. Ausblick</a></li><li><a href="#a5.Quellenangaben">5. Quellenangaben</a></li></ol><h2 id="Spring">Spring</h2><p>Für die Entwicklung des Backends wurde das <a href="http://www.springsource.org/">Spring Framework</a> verwendet. Spring ist ein Framework für die vereinfachte Entwicklung von Java EE Anwendungen. Beim Backend wurde sehr viel das Prinzip des <a href="http://de.wikipedia.org/wiki/Dependency_Injection">Dependency Injection</a> verwendet.</p><p>Neben <strong>Spring Core</strong> wurden die folgenden Spring-Projekte im Backend verwendet:</p><ul><li><strong>Spring MVC</strong>: Model-View-Controller-Prinzip für die Erstellung von Webanwendungen</li><li><strong>Spring Security</strong>: Absicherung von Java-Anwendungen und Webseiten</li><li><strong>Spring LDAP</strong>: Zugriff auf LDAP-Systeme</li><li><strong>Spring IDE</strong>: Entwicklungsunterstützung bei der Erstellung von Spring-Anwendungen (ist in der STS enthalten)</li></ul><h2 id="Projektstruktur">Projektstruktur</h2><p>Die Projektstruktur des Backend sieht folgendermaßen aus:</p><p><img border="0" src="imge_projektstruktur.jpg"/></p><p class="imgtext"><em>Abbildung:</em> Projektstruktur</p><p>In Verzeichnis <code>src_main</code> befinden sich die eigentlichen Java-Klassen, Konfigurationen, Initialwerte und Excel-Templates. Dabei sind unter <code>context</code> Hilfsdateien zum Zugriff auf den ApplicationContext und den Entitymanager zu finden. In <code>dao</code> sind Klassen (Data Access Objects) zum Zugriff auf die Datenobjekte in der Datenbank. Für die Benennung der Tabellen und Attribute in der Datenbank exisitiert unter <code>repository</code> eine Java-Klasse. Unter <code>service</code> sind die verschieden Serviceklassen zu finden, die im Backend an verschieden Stellen verwendet werden und über den ApplicationContext erreichbar sind. Hierzu gehören die Klassen:</p><ul><li>für den Zuständigkeitsfinder (<code>classification</code>), </li><li>für das Ausführen der Webanwendung in einem Cluster (<code>cluster</code>), </li><li>zum Synchronisieren der Frontend- und BackendDb (<code>dbsync</code>), </li><li>zum Zugriff auf den WFS und den TMS (<code>geo</code>),</li><li>zur Manipulation von Bildern (<code>image</code>),</li><li>zur Initialisierung der DB und der Webanwendung (<code>init</code>),</li><li>zum Ausführen von Jobs im Hintergrund (<code>job</code>),</li><li>zum Versenden von Emails (<code>mail</code>),</li><li>zum Erstellen von Excel-Dateien (<code>poi</code>),</li><li>zur Arbeit mit Benutzern und Rechten und zum Zugriff auf ein LDAP-Server (<code>security</code>),</li><li>zum Arbeiten mit Konfigurationseinstellungen (<code>settings</code>) und</li><li>zum Erstellen von statistischen Daten (<code>statistic</code>). </li></ul><p>In <code>tld</code> sind Klassen zur implementierung verschiedener Taglibs zu finden. <code>util</code> stellt verschiedene globale Hilfskalssen und -funktionen bereit. Im Verzeichnis <code>vo</code> sind die eigentlichen Businessobjekte (POJO) vorhanden, die die eigentlichen Daten enthalten und in der Datenbank abgelegt werden. Unter <code>web</code> sind die verschiedenen Controller und Commands für die Implementierung der eigentlichen Weboberfläche nach dem Model-View-Controller-Prinzip zu finden.</p><p>Das Verzeichnis <code>META-INF</code> beinhaltet verschiedene Dateien für die Initialisierung der Datenbank (<code>oviwkt</code>, <code>spring</code> und <code>sql</code>), Templates zur Erstellung von Excel-Dateien (<code>templates</code>) sowie Einstellungen und Konfigurationen. Der eigentliche ApplicationContext wird in <code>spring</code> konfiguriert und lässt sich teilweise über die <code>settings.properties</code> anpassen. Der PersistenceContext ist in <code>persistence.xml</code> und ein Cache zu cachen von speziellen Anfragen an das LDAP sowie den WFS istt in <code>ehcache.xml</code> konfiguriert. Die Einstellungen zum Logging sind in <code>log4j.properties</code> festgelegt.</p><p><code>src_test</code> enthält Dateien zum Testen (JUnit, Selenium) verschiedener Funktionen.</p><p>Für das Einbinden von Bibliotheken wird Maven verwendet. Die Einstellungen hierzu sind in der Datei <code>pom.xml</code>. Neben den Bibliotheken, die über das Dependency Management von Maven eingebunden werden (<code>Maven Dependencies</code>) arbeitet das System mit den Standardbibliotheken von Java (<code>JRE System Library</code>), den Bibliotheken des Servlet-Container Tomcat (<code>Apache Tomcat v7.0</code>) sowie mit Bibliotheken, die nicht über Maven bezogen werden konnten (<code>Web App Libraries</code> bzw. <code>WebContent/WEB-INF/lib</code>)</p><p>Das Verzeichnis <code>WebContent</code> beinhaltet die eigentlichen Dateien für die Webanwendung. Unter <code>dokumentation</code> sind das Benutzerhandbuch und das Entwicklerhandbuch zu finden. Dieses ist ebenfalls der Ort, wo das JavaDoc hin generiert werden soll. Sämtliche Bilder sind unter <code>images</code> zu finden. Unter <code>script</code> sind die verschiedensten JavaScript-Dateien zu finden. <code>styles</code> beinhaltet die CSS-Dateien für die Layoutdefinition. Unter <code>WEB-INF</code> sind die Definition des WebApplicationContext (<code>spring</code>), verscheidenen Definitionen von Taglibs (<code>tags</code>) und die eigentlichen JSPX- sowie Tiles-Dateien (<code>view</code>) zu finden.  </p><h2 id="WebanwendungmitSpring">Webanwendung mit Spring</h2><p>Die Webanwendung des Backends wurde auf der Basis von Spring und Spring MVC entwickelt. Spring MVC stellt hierzu das MVC-Pattern bereit. Dabei wird der Presentation-Layer einer Webanwendung folgendermaßen aufgeteilt:</p><ul><li><strong>Model</strong>: Dabei handelt es sich um einen Datencontainer. Dieser enthält i.d.R. nur die reinen Datenobjekte und keine weitere Logik. Zu den Datenobjekten gehören hierbei z.B. die eigentlichen Businessdaten (<code>src_main\de\fraunhofer\igd\klarschiff\vo\...</code>) oder auch spezielle Command-Objekte (<code>src_main\de\fraunhofer\igd\klarschiff\web\..Command</code>), die bei seitenübergreifenden Aktionen verwendet werden. </li><li><strong>View</strong>: Die View stellt die Daten aus dem Model in einer GUI-Oberfläche dar. Hierfür werden die JSPX-Dateien (<code>WebContent\WEB-INF\views\..jspx</code>) und teilweise Taglibs verwendet.</li><li><strong>Controller</strong>: Der Controller steuert die Abfolge, generiert und bearbeitet die Daten des Models und startet den View. Die Controller-Klassen sind unter <code>src_main\de\fraunhofer\igd\klarschiff\web\..Controller</code> zu finden. </li></ul><p>Die einzelnen Controller werden beim Backend durch die Annotation <code>\@Controller</code> beim WebApplicationContext registriert. Die Zuordnung der URLs zu den Controllern erfolgt mit Hilfe der Annotation <code>\@RequestMapping</code>.</p><p>Für die Sichten wird beim Backend zusätzlich Tiles verwendet, welches die Verwendung von Templates ermöglicht.</p><p><strong>Validierung</strong></p><p>Werden innerhalb der Webanwendung Validierungen benötigt, so sind diese i.d.R. in den entsprechenden Command-Objekten zu finden, z.B.:</p><pre><code>public void validate(BindingResult result) {
	...
	assertNotEmpty(this, result, Assert.EvaluateOn.ever, "vorgang.typ", null);
	...
}

</code></pre><p>Dei Validierung wird dabei über die Controller initiert.</p><pre><code>@RequestMapping(method = RequestMethod.POST)
public String submit(@ModelAttribute("cmd") VorgangNeuCommand cmd, BindingResult result, ModelMap model, HttpServletRequest request) {
	Vorgang vorgang = cmd.getVorgang();
	...	
	cmd.validate(result);
	...
}



</code></pre><h2 id="Zustndigkeitsfinder">Zuständigkeitsfinder</h2><p>Für die automatische Zuordnung einer Zuständigkeit zu einem Vorgang wird im Backend ein Lernalgorithmus verwendet. Hierbei wird eine <a href="http://de.wikipedia.org/wiki/Bayessches_Netz">Bayessches Netz</a> eingesetzt, welches in <a href="http://sourceforge.net/projects/weka/">Weka</a> implementiert ist. Ein Lernalgorithmus wird i.d.R. mit Hilfe einer Trainingsmenge angelernt. Auf dieser Basis kann das Bayessches Netz dann eine Klassifikation durchführen. <br/>Zum Trainieren und Klassifizieren werden dem Lernalgorithmus Tupel bzw. Instanzen bestehend aus verschieden Features bereitgestellt. Bei den Features werden im Backend die Kategorie, berechnete Werte (Abstand innerhalb einer Fläche, Abstand zu einer Fläche, Größe der Fläche) auf Basis der Position zu bestimmten Layern im WFS (Bewirtschaftung, Grünfläche etc.) sowie die Zuständigkeit verwendet. Zur Berechnung der Features ist die Klasse <code>FeatureService</code> verantwortlich. debei werden teilweise Cachingmechanismen verwendet, um wiederholte Berechnung gleicher Werte zu vermeiden.</p><p>Als Trainingsmenge werden im Backend die aktuellsten Vorgänge mit einer akzeptierten Zuständigkeit verwendet. Ist die Trainingsmenge nicht ausreichend, wird die Trainingsmenge um zusätzliche Instanzen erweitert, die sich aus vordefinierten Kategorie-Zuständigkeit-Kombinationen ergeben (siehe <code>src_main\de\fraunhofer\igd\klarschiff\vo\Kategorie.java</code> und <code>src_main\META-INF\spring\applicationContext-init.xml</code>).</p><p>Wird bei der Benutzung des Systems eine Zuständigkeit akzeptiert, wird die Trainingsmenge des Lernalgorithmuses um die Instanz erweitert und der Lernalgorithmus aktualisiert. </p><pre><code>private void updateClassifier(Vorgang vorgang, ClassificationContext ctx) throws Exception {
	Instance instance = featureService.createFeature(vorgang, true, ctx);
	instance.setDataset(ctx.getDataset());
	ctx.getClassifier().updateClassifier(instance);
}

</code></pre><p>Zusätzlich wir der Lernalgorithmus in periodischen Abständen durch einen Hintergrundjob komplett aktualisiert.</p><pre><code>public void reBuildClassifier() throws Exception {
	logger.debug("rebuild ClassificationContext");
	ClassificationContext ctx = new ClassificationContext();
	//Klassifikator neu initialisieren
	ctx.setClassifier(new NaiveBayesUpdateable());
	//attributes und classAttribut neu initialisieren
	featureService.initClassificationContext(ctx);
	//Dataset neu laden
	ctx.setDataset(new Instances("", ctx.getAttributes(), 0));
	ctx.getDataset().setClass(ctx.getClassAttribute());
	//Trainingset neu erstellen
	Instances trainSet = createTrainset(ctx);
	//Klassifikator neu trainieren
	ctx.getClassifier().buildClassifier(trainSet);
	//neuen context setzen
	this.ctx = ctx;
}



</code></pre><h2 id="Einstellungen">Einstellungen</h2><p>Die Konfigurationen und Einstellungen der Anwendung werden an verschiedenen Stellen vorgenommen. Zentraler Punkt für die Einstellungen ist die <code>settings.properties</code>. Hier können alle Parameter für den Lauf der Anwendung angepasst werden.</p><p>Systemspezifischere Anpassungen, die z.B. bei der Weiterentwicklung vorgenommen werden müssen, können im ApplicationContext (<code>src_main\META-INF\spring\..xml</code>), dem WebApplicationContext (<code>WebContent\WEB-INF\spring\webmvc-config.xml</code>)oder an anderen Stellen vorgenommen werden.</p><p>Bei den Einstellungen in der <code>settings.properties</code> können Profile verwendet werden. Diese ermöglichen es verschiedene Einstellungen zu definieren, die gleiche Webanwendung auf verschiedenen Rechnern zu deployen und da jeweils unterschiedliche Konfigurationen zu verwenden. Welches Profil verwendet wird kann über die Variable <code>KLARSCHIFF_HRO_PROFILE</code> an den folgenden Stellen festgelegt werden:</p><ul><li>Umgebungsvariable des Rechners</li><li>Java-Laufzeit-Umgebungsvariable</li><li>in der Datei <code>settings.properties</code></li></ul><p>Die Spezialisierung eines Parameters für ein bestimmtes Profil erfolgt durch ein Voranstellen des Profilnamens in der <code>settings.properties</code>. Die Einstellungen werden beispielsweise folgendermaßen definiert:</p><pre><code>mail.from=klarschiffhro@googlemail.com
igd_dev.mail.from=klarschiffhro@igd-r.fraunhofer.de

</code></pre><p>so wird im Normalfall als Absenderadresse die Emailadresse von Google verwendet. Ist das Profil <code>igd_dev</code> eingestellt, so wird die Emailadresse vom Fraunhofer verwendet.</p><p>Die folgenden Einstellungen können in der <code>settings.properties</code> vorgenommen werden:</p><p><strong>Mailversand</strong></p><ul><li><code>mail.server.baseurl.backend</code> und <code>mail.server.baseurl.frontend</code>: Die URLs werden bei der Erzeugung von Emails verwendet und sollten auf die entsprechenden URLs des Frontends und Backends verweisen.</li><li><code>mail.host</code>: SMTP-Host, der für den Versand der Emails verwendet wird</li><li><code>mail.smtp.starttls.enable</code>: aktiviert (<em>true</em>) oder deaktiviert (<em>false</em>) die Verschlüsselung mit dem SMTP-Host; Eine Aktivierung wird z.B. bei der Verwendung eines Google-Mail-Accounts benötigt.</li><li><code>mail.username</code> und <code>mail.password</code>: Benutzername und Passwort für den SMTP-Zugang, wenn dieser benötigt wird</li><li><code>mail.from</code>: Absenderadresse für die vom System versendeten Emails</li><li><code>mail.sendAllMailsTo</code>: Wenn hier eine Emailadresse angegeben wird, werden alle Emails an diese Adresse versendet. Dieses ist beispielsweise zum Test der Emailfunktionen sinnvoll.</li></ul><p><strong>Datenbank</strong></p><ul><li><code>database.host</code>, <code>database.port</code>, <code>database.schema</code>, <code>database.dbname</code>, <code>database.username</code> und <code>database.password</code>: Host, Port, Schema, Name der Datenbank, Benutzername und Password der verwendeten Datenbank für das Backend</li></ul><p><strong>Datenbanksynchronisation</strong></p><ul><li><code>database.initscript</code>: Hiermit wird festgelegt, ob das SQL-Script, welches für die Synchronisation der Frontend- und BackendDb auf der Basis von dbLink, ausgeführt wird. Das Script wird nur ausgeführt, wenn noch keine Tabellen in der BackendDb vorhanden sind. Die Ausführung erfolgt nach dem Erzeugen der Tabbellen in der BackendDb. Folgende Werte sind möglich: <code>disabled</code> - Script wird nicht ausgeführt, <code>warn</code> - Script wird ausgeführt und es gibt im Log eine Fehlermeldung bei einem Fehler, <code>error</code> - Script wird ausgeführt und der Start des Backends wird im Fehlerfall abgebrochen.</li><li><code>dbsync.programdir</code>: Gibt das Verzeichnis an, wo das Programm zum Synchronisieren der Frontend- und BackendDb auf der Basis von <a href="http://de.talend.com/products-data-integration/talend-open-studio.php">Talend Open Studio</a> liegt.</li></ul><p><strong>Automatische Jobs</strong></p><ul><li><code>job.monthsToArchivVorgaenge</code>: Alte abgeschlossene Vorgänge in Monaten, bis diese automatisch archiviert werden.</li><li><code>job.hoursToRemoveUnbestaetigtVorgang</code>: Alter von unbestätigten Vorgängen in Stunden, bis diese automatisch gelöscht werden.</li><li><code>job.hoursToRemoveUnbestaetigtUnterstuetzer</code>: Alter von unbestätigten Unterstützungen in Stunden, bis diese automatisch gelöscht werden.</li><li><code>job.hoursToRemoveUnbestaetigtMissbrauchsmeldung</code>: Alter von unbestätigten Missbrauchsmeldungen in Stunden, bis diese automatisch gelöscht werden.</li></ul><p><strong>Geo</strong></p><ul><li><code>geo.map.projection</code>: Verwendete Projektion im System</li></ul><p><strong>Kartendarstellung mit OpenLayers</strong></p><ul><li><code>geo.map.tms.server</code>: TMS für die Darstellung der Karten im Backend</li><li><code>geo.map.tms.server.layers</code>: Layer des TMS, die bei der Kartendarstellung verwendet werden sollen. Format: [LayerNameInDerAnzeige1]:[LayernameBeimTms1],[LayerNameInDerAnzeige2]:[LayernameBeimTms2],...</li><li><code>geo.map.maxExtent</code>: Begrenzen der Daten der Karte</li><li><code>geo.map.restrictedExtent</code>: Maximal anzuzeigende Größe der Karte</li><li><code>geo.map.resolutions</code>: Zoomstufen</li><li><code>geo.map.ovi.margin</code>: Darzustellender Umkreis bei der Anzeige eines Ortes</li></ul><p><strong>Darstellung eines Vorgangs bzw. des Ortes in einem externen System</strong></p><ul><li><code>geo.map.extern.projection</code>: Projektion im externen System (<code>geo.map.extern.url</code>)</li><li><code>geo.map.extern.url</code>: URL zur Darstellung eines Vorganges in einem externen System (es können die Variablen <span>x</span>, <span>y</span> und <span>id</span> verwendet werden)</li><li><code>geo.map.extern.extern.url</code>: URL zur Darstellung eines Vorgangs in einem externen System, was von jedem Nutzer im Internet aufgerufen werden kann (es können die Variablen <span>x</span>, <span>y</span> und <span>id</span> verwendet werden)</li></ul><p><strong>Anbindung des WFS für den Zuständigkeitsfinder</strong></p><ul><li><code>geo.wfs.url</code>: URL zum Aufruf der Capabilities des WFS</li><li><code>geo.wfs.wfs.exception.handling</code>: ExceptionHandling beim Initalisieren des WFS (<code>warn</code> - Fehlermeldungen werden in das Log geschrieben, <code>error</code> - der Start der Webanwendung wird bei einem Fehler abgebrochen)</li><li><code>geo.wfs.ovi.buffer</code>: Umkreis in Metern, der bei der Berechnung der Features für den Zuständigkeitsfinder berücksichtigt werden soll</li></ul><p><strong>Proxy</strong></p><ul><li><code>proxy.host</code> und <code>proxy.port</code>: Proxyeinstellungen, die der Server zur Kommunikation mit dem Internet benötigt. Dieses wird z.B. für die Kommunikation mit WFS benötigt.</li></ul><p><strong>LDAP</strong><br/>Es kann ein LDAP-Sever verwendet werden oder auf der Basis einer LDIF-Datei lokal ein LDAP mitgestartet werden, der dann verwendet wird. Hierzu ist jeweils der eine Parameter <code>ldap.server.ldif</code> oder <code>ldap.server.url</code> zu setzen und der andere frei zu lassen.</p><ul><li><code>ldap.server.ldif</code>: Wenn der Wert gesetzt ist, wird ein lokaler LDAP gestartet und die Daten aus der angegebenen LDIF-Datei verwendet.</li><li><code>ldap.server.url</code>: URL eines LDAP-Servers.</li><li><code>ldap.root</code>: Rootpfad für die Anfragen an den LDAP</li><li><code>ldap.managerDn</code> und <code>ldap.managerPassword</code>: Zugangsdaten für den LDAP-Server</li><li><code>ldap.userSearchBase</code>: Pfad in dem nach Benutzern gesucht werden soll</li><li><code>ldap.userObjectClass</code>: Objektklasse für Benutzer</li><li><code>ldap.userSearchFilter</code>: Filter zum Suchen von Benutzern</li><li><code>ldap.groupSearchBase</code>: Pfad in dem nach Gruppen gesucht werden soll</li><li><code>ldap.groupObjectClass</code>: Objektklasse für Gruppen</li><li><code>ldap.groupRoleAttribute</code>: Attribut in dem bei den Gruppen die Rolle <em>intern</em> oder <em>extern</em> gesetzt ist</li><li><code>ldap.groupSearchFilter</code>: Filter in denen bei den Gruppen nach Benutzern gesucht wird</li><li><code>ldap.groupObjectId</code>: Attribut mit der ID für die Gruppe</li><li><code>ldap.userAttributesMapping</code>: Mapping für das Auslesen der Daten eines Benutzers beim LDAP. Format: [AttributNameAnwendung1]=[AttributNameLdap1],[AttributNameAnwendung2]=[AttributNameLdap2],...</li><li><code>ldap.roleAttributesMapping</code>: Mapping für das Auslesen der Daten einer Gruppe beim LDAP. Format: [AttributNameAnwendung1]=[AttributNameLdap1],[AttributNameAnwendung2]=[AttributNameLdap2],...</li></ul><ol><li>Logins mit Password auf der Loginseite #</li></ol><p>show.logins=false</p><p>igd_dev.show.logins=true<br/>wheregroup_test.show.logins=true</p><ol><li>Anzahl Unterstützer bei Ideen #</li></ol><p>vorgang.idee.unterstuetzer=10</p><ol><li>Fehler #</li></ol><p>show.fehler.details=true<br/>bug.tracking.url=https://trac.wheregroup.com/klarschiff.hro/</p><ol><li>Cluster #</li></ol><p>cluster.mode=none<br/>hro_test.cluster.mode=multipleMachines<br/>igd_dev.cluster.mode=singleMachine</p><ol><li>Version #</li></ol><p>version=1.0 beta (M_10 M1) 2011-09-26</p><ul><li>Open Layers</li><li>GeoTools</li><li>ApplicationContext</li></ul>* xml
 * settings
 * autowired
 * de...context<ul><li>dao</li><li>Datenbank</li></ul>* JPA
 * Hibernate
 * Hibernate spatial
 * persitenz.xml
 * entitimanager<ul><li>Cluster</li><li>EHCache</li><li>WMS, WFS</li><li>Mail</li><li>Apache POI</li></ul>* Excel<ul><li>DB init</li><li>LDAP</li><li>JSP Tags</li><li>VO</li></ul>* vo
 * vo.extra<ul><li>Postgres, Postgis</li><li>JQuery</li><li>DD Drop Down Panel</li><li>JavaScript</li><li>Tiles</li></ul><h2 id="Encoding">Encoding</h2><p>java Cp1252<br/>jspx UTF-8</p><h2 id="Dokumentation">Dokumentation</h2><p>http://help.eclipse.org/helios/index.jsp?topic=/org.eclipse.mylyn.wikitext.help.ui/help/Mylyn%20WikiText%20User%20Guide.html</p><h2 id="Javadoc">Javadoc</h2><p>Project -&gt; Generate Javadoc -&gt; Next -&gt; on the last page, in Extra Javadoc options write:<br/>-encoding Cp1252 -charset UTF-8 -docencoding UTF-8</p><p>Themenvorschläge:</p><p>###################<br/><b>Entwicklerdokumentation</b></p><p>Version 1.0</p><p>Oktober 2011</p><p>Ansprechpartner</p><p>Name1 &amp; Name2</p><p>Email</p><p>Mail@Adresse.de</p><p>Webseiten</p><p>http.//www.klarschiff.de<br/>https://github.com/klarschiff</p><h1 id="a1.Einleitung">1. Einleitung</h1><h2 id="a1.1WasistKlarschiff">1.1 Was ist Klarschiff</h2><h2 id="a1.2WarumKlarschiff">1.2 Warum Klarschiff</h2><h2 id="a1.3Lizenz">1.3 Lizenz</h2><p>Klarschiff wird unter der Open-Source Lizenz GNU General Public License (GPL) entwickelt. Mehr Informationen dazu finden Sie unter <a href="http://www.opensource.org">http://www.opensource.org</a>.</p><h2 id="a1.4MglichkeitenzurMitwirkung">1.4 Möglichkeiten zur Mitwirkung</h2><p>Klarschiff kann weiterentwickelt werden und zwar nicht nur von den ursprünglichen Entwicklern, sondern auch von anderen Softwareentwicklern, die Interesse daran haben an diesem Open-Source Projekt mitzuwirken.</p><h2 id="a1.5Entwicklerdokumentation">1.5 Entwicklerdokumentation</h2><p>Ziel dieser Dokumentation ist es, Softwareentwickler bei der Programmierung von Klarschiff oder bei der Verwendung von Teilen des Programmcodes (z.B. Geokomponenten, Email Service...) zu unterstützen. (Hierbei handelt es sich allerdings nicht um eine API Dokumentation.) Zum Verstehen der Dokumentation werden Grundlagenkenntnisse in Java sowie deren Technologien (z.B. .jspx) und Software-Architekturmustern wie MVC (Model-View Controller) vorausgesetzt.</p><h1 id="a2.Allgemeines">2. Allgemeines</h1><h2 id="a2.1Programmiersprache">2.1 Programmiersprache</h2><p>Klarschiff wurde in der Programmiersprache Java unter Verwendung der Java 2 Standard Edition (J2SE) 6.0 der Firma SUN Microsystems (Tochterunternhemen von Oracle) entwickelt. Als serverseitige Web-Programmiersprache zur dynamischen Erzeugung der HTML-Ausgaben wurden JavaServer Pages Extended eingesetzt.<br/>(Vorteile von Java 6 gegenüber anderen Programmiersprachen bzw. der Vörgängerversion Java 5 erläutern? Warum für Java entschieden? &gt; plattformunabhängig, weite Verbreitung, leichte Einbindung Software Dritter=Verkürzung Entwicklungszeit)</p><h2 id="a2.2SoftwaredritterParteien">2.2 Software dritter Parteien</h2><p>Für Klarschiff wurde die nachfolgende freie Software integriert:<br/>I. Karte &#8222;openMaps&#8221;?<br/>II. ...</p><h2 id="a2.3Systemvoraussetzungen">2.3 Systemvoraussetzungen </h2><h3 id="a2.3.1ZurAusfhrungvonKlarschiff">2.3.1 Zur Ausführung von Klarschiff</h3><p>Zur Ausführung von Klarschiff wird eine eine Java Runtime Environment (JRE) der Java 2 Standard Edition (J2SE) vorausgesetzt. Minimum ist die aktuelle Version 6.0 (auch 1.6 genannt). (Zu älteren Versionen ist der Byte-/Sourcecode wegen der Compatibility Policies von SUN nicht kompatibel.)<br/>Diese Java-Version ist auf den Standard-Betriebssystemen nicht vorinstalliert. Das bedeutet Sie muss heruntergeladen und installiert werden (<a href="http://www.oracle.com/technetwork/java/javase/downloads/index.html)">Download JRE</a>. Klarschiff wird in Form einer WAR (Web Archive) File (und JAR?) angeboten, für die das JRE installiert sein muss.</p><h3 id="a2.3.2ZurEntwicklungvonKlarschiff">2.3.2 Zur Entwicklung von Klarschiff</h3><p>Zur Entwicklung muss das Java Development Kit (JDK) mindestens in der Version 6.0 der Java 2 Standard Edition (J2SE) vorhanden sein. (<a href="http://www.oracle.com/technetwork/java/javase/downloads/index.html)">Download JDK</a></p><h2 id="a2.4Entwicklungsumgebung">2.4 Entwicklungsumgebung</h2><h3 id="a2.4.1EntwicklungsumgebungFrontend">2.4.1 Entwicklungsumgebung Frontend</h3><p>(TODO: besser strukturieren)<br/> Spring (Version 2.7.1, Zeichencodierung jspx-Seiten: UTf-8, java Cp1252)<br/> Datenbank (PostgreSQL 8.4 oder 9.0 mit PostGIS 1.5, x86 = 32 Bit)</p><ul><li>Eingabe folgender Daten in pgAdmin</li></ul><p>Frontend:<br/>    DB: klarschiff_backend<br/>    User: klarschiff_backend<br/>    Pass: klarschiff_backend<br/>    Port: 5432</p><h3 id="a2.4.2.EntwicklungsumgebungBackend">2.4.2. Entwicklungsumgebung Backend</h3><p><strong>Datenbank aufsetzen</strong></p><p>Als Datenbank verwendet Klarschiff PostgreSQL ab der Version 8.4. Für PostgreSQL wird noch die Erweiterung PostGIS ab der Version 1.5 eingesetzt. PostgreSQL mit PostGIS bildet eine Geodatenbank.</p><ul><li>PostgreSQL (Download und Installation)<ul><li>PostgreSQL herunterladen (http://www.postgresql.org/download/)</li><li>Bei der Installation den Standardport 5432 beibehalten. </li></ul></li><li>PostGIS (Download und Installation)<ul><li>Download erfolgt über den in PostgreSQL enthaltenen Application Stack Builder (als Admin starten!)</li><li>Im Application Stack Builder die Registerkarte Spatial Extension öffnen und PostGIS auswählen</li></ul></li><li>Benutzer anlegen<ul><li>in pgAdmin Doppelklick auf Server &gt; PostgreSQL</li><li>Rechtsklick auf Login-Rollen &gt; &#8222;Neue Login-Rolle...&#8221;  (z.B. Rollenname: klarschiff_backend, Passwort=klarschiff_backend)</li><li>Beim Karteireiter Rollenprivilegien entsprechende Rechte vergeben</li></ul></li><li>Datenbank anlegen<ul><li>in pgAdmin Doppelklick auf Server &gt; PostgreSQL &gt; Rechtsklick auf Datenbank &gt; "Neue Datenbank..."</li><li>Eigenschaften:<ul><li>Name: klarschiff_backend</li><li>Kodierung: UTF-8</li><li>Vorlage: template_postgis</li></ul></li><li>Das Erstellen der Datenbankstruktur erfolgt beim ersten Start von Klarschiff automatisch</li></ul></li></ul><p><strong>Java</strong></p><p>(TODO: redundant, d.h. entweder dies oder bei 2.3 Systemvoraussetzungen löschen)<br/>Java herunterladen und installieren: <br/>Das Projekt Klarschiff ist in der Programmiersprache Java geschrieben und deshalb wird ein JDK (min. Java SE 6) benötigt. </p><ul><li><a href="http://www.oracle.com/technetwork/java/javase/downloads/index.html">Download JDK</a></li></ul><p><strong>Tomcat</strong></p><p>Tomcat herunterladen und installieren: <br/>Für Klarschiff wird eine Laufzeitumgebung/Servlet-Container benötigt. Hierzu wird der Apache Tomcat ab der Version 7 benötigt.<br/>Unter Win7 sollte der Tomcat nicht unter dem Verzeichnis C:\[Programme]\ ausgepackt werden, da bei der Verwendung vom Tomcat ggf. in dem Verzeichnis Schreiboperationen notwendig sind, wofür dann wiederum Adminrechte notwendig sind.</p><ul><li><a href="http://tomcat.apache.org/download-70.cgi">Download Tomcat</a></li></ul><p><strong>Spring Tool Suite (STS)</strong></p><p><ins>STS herunterladen und installieren:</ins> STS ist ein speziell für die Arbeit mit Spring angepasstes Eclipse. Es ist empfehlenswert für die Arbeit mit Klarschiff daher STS zu verwenden. Alternativ kann natürlich auch mit einem üblichen Eclipse gearbeitet werden. Hier sind dann ggf. noch verschiedene Plugins nachzuinstallieren. </p><ul><li><a href="http://www.springsource.com/products/eclipse-downloads">Download STS</a></li></ul><p>STS kann nun gestartet werden. Hierbei ist ein entsprechender workspace zu verwenden.</p><p><ins>Proxy konfigurieren (optional):</ins><br/>Wenn ein Proxy zur Verbindung mit dem Internet verwendet wird, muss dieser an zwei Stellen eingestellt werden. Zum einen sind die Proxyeinstellungen für das STS vorzunhemen (Window &gt; Preferences &gt; General &gt; Network Connections). Für die Arbeit mit Maven ist ebenfall der Proxy in der settings.xml (Window &gt; Preferences &gt; Maven &gt; Installations &gt; settings.xml) einzustellen. Wie man einen Proxy für Maven in der settings.xml einstellt ist unter <a href="http://maven.apache.org/guides/mini/guide-proxies.html">http://maven.apache.org/guides/mini/guide-proxies.html</a> zu erfahren.</p><p><ins>Tomcat registrieren:</ins><br/>Der ausgepackte Tomcat ist im STS zu registreren (Window &gt; Preferences &gt; Server &gt; Runtime Environments &gt; Add &gt; Apache &gt; Apache Tomcat v7.0 &gt; ...). Beim tomcat installation directory ist dann das Verzeichnis des ausgepackten Tomcat anzugeben.</p><p><ins>Git Client einrichten:</ins><br/>(TODO: detailliertere Anleitung erstellen) <br/>Das Projekt Klarschiff befindet sich in einem GitRepository (Link...). Hierfür ist ein entsprechender Git Client zu installieren. (Evtl. Der Git Client lässt sich direkt über das Dashboard in STS installieren (Help &gt; Dashboard &gt; Extension)).</p><p><ins>Projekt aus dem Git Repository auschecken:</ins><br/><img border="0" src="nochmal Testen"/><br/>Das Projekt klarschiff.webapp kann nun aus dem Git Repository (Bsp. https://github.com/projektklarschiffhro) ausgecheckt werden. <br/>Hierzu muss zunächst zur <code>Git Repository Exploring perpective</code> (Window &gt; Open perspective &gt; Other... &gt; Git Repository Exploring) gewechselt werden. Anschließend auf den Button <img border="0" src="img_gitCloneButton.jpg"/> <code>Clone a Git Repository and add the clone to this view</code> klicken und die benötigten Eingaben erledigen (siehe Abbildung). Es genügt folgenden Text in die <code>URI</code> einzutragen: <em>https://projektklarschiffhro@github.com/projektklarschiffhro/First-Repository-Klarschiff.git</em>, eine Passworteingabe ist natürlich nicht notwendig.</p><p><img style="width:30%" border="0" src="img_gitEingabedaten.jpg"/></p><p class="imgtext"><em>Abbildung:</em> Git Repository Daten</p><p>Anschließend klicken Sie beim nächsten Fenster auf <em>Next &gt;</em>. Im darauffolgenden Fenster haben Sie nun die Möglichkeit einen Zielpfad für den Ort des Repositorys festzulegen (siehe Abbildung).</p><p><img style="width:30%" border="0" src="img_gitDestination.jpg"/></p><p class="imgtext"><em>Abbildung:</em> Git Zielpfad für das Repository</p><p>Zum Schluss bestätigen Sie nur noch Ihre Eingaben indem Sie auf <em>finish</em> klicken. Das Repository befindet sich nun lokal auf Ihren Computer. Es muss allerdings noch in den Java-Workspace ausgecheckt werden. Dazu öffnen Sie den Ordner <code>Working directory</code> in der <code>Git Repository Exploring perpective</code> wählen das gewünschte Projekt aus (z.B. FirstGitProject) unnd machen dort einen Rechtsklick drauf und wählen <code>Import Projects...</code> aus (siehe Abbildung). Anschließend <code>Import Existing Projects</code> auswählen, auf <em>Next &gt;</em> klicken und mit <em>Finish</em> bestätigen.</p><p><img style="width:30%" border="0" src="img_gitCheckOut.jpg"/></p><p class="imgtext"><em>Abbildung:</em> Auschecken des Projektes in den Workspace</p><p>Das Projekt klarschiff.webapp kann nun ausgecheckt werden. Nach dem Auschecken fängt die STS sofort an über Maven die ganzen Java Bibliotheken herunterladen. Dieses kann ggf. lange dauern oder auch mal zum Stillstand führen. Speziell mit den Proxyeinstellungen kann es zu Problemen kommen, die aber nicht immer nachvollziehbar sind. Wenn es also zu Problemen kommt, die STS mal mit dem Taskmanager beenden und neustarten. </p><p><ins>Projekt zum Server hinzufügen:</ins><br/>Damit das Projekt auch vom Tomcat ausgeführt wird, ist dieses in der View <em>Server</em> bei einem entsprechendem Tomcat zu registrieren. Der Tomcat muss ggf. zuvor in der View hinzügefügt werden (Rechtsclick in die View &gt; New &gt; Server &gt; ...). Beim entsprechendem Tomcat kann nun das Projekt Klarschiff hinzugefügt werden (Rechtsclick auf den Tomcat &gt; Add and Remove ... &gt; ...). Da der Tomcat beim Start ggf. etwas länger braucht (speziell beim ersten mal) kann hierfür auch die Startzeit etwas hochgesetzt werden (Doppelclick auf den tomcat &gt; Timeouts &gt; ...).</p><p>Getting Started: Nun ist alles so weit, dass das ganze gestartet wird und man mit der eigentlichen Arbeit anfangen kann.  </p><h1 id="a3.Softwarekomponenten">3. Softwarekomponenten</h1><h2 id="a3.1Email">3.1 Email</h2><p>Die Klassen für die Email-Funktion befinden sich im package de.fraunhofer.igd.klarschiff.service.mail. Es hat folgenden Inhalt:</p><p><ins>Klassen:</ins></p><ul><li>JavaMailSenderImpl.java</li><li>MailSenderJob.java</li><li>MailService.java</li></ul><p>Die Darstellung des Mail-Formulars auf der Webseite wird mittels einer .jspx Seite realisiert und befindet sich unter WebContent &gt; WEB-INF &gt; views &gt; vorgang &gt; printEmail</p><p><ins>Anzeige</ins><br/>email.jspx (Email-Formular)<br/>emailSubmit.jspx (Bestätigungsfenster)</p><p>Sie haben einerseits die Möglichkeit eine Email mit dem eigenen Mail-Client zu versenden oder ein Formular zu benutzen. Bei der Verwendung des Mail-Formulars können Sie zusätzlich noch bestimmen welche Daten (Karte, Foto, Kommentare, Missbrauchsmeldungen) Sie als Anhang mitsenden wollen. Bei Verwendung des eigenen Email-Clients werden automatisch alle Daten mitgesendet.</p><p>Die Klasse JavaMailSenderImpl.java hat die Aufgabe des Setzens des Usernamens und Passwortes.</p><h2 id="a3.2Sonstiges">3.2 Sonstiges</h2><p>Drucken / Foto / Fehlerbehandlung (z.B. assertNotEmpty) / Datenbank (hibernate) Geokomponenten (Karte) / Exportieren (Suchergebnisse &gt; Excel)</p><p>Jedes Paket beschreiben was es enthält? z.B. de.fraunhofer.igd.klarschiff.web</p><h1 id="a4.Ausblick">4. Ausblick</h1><h1 id="a5.Quellenangaben">5. Quellenangaben</h1></body></html>